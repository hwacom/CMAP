var resultTable_blockedIpRecord,blockedIpTableHeight,blockReasonShowLength=30,openReasonShowLength=30,_navAndMenuAndFooterHeight=0,_deductHeight=0;function calBlockedIpSectionHeight(){_navAndMenuAndFooterHeight=0,_deductHeight=0,_navAndMenuAndFooterHeight="none"!=$(".mobile-menu").css("display")&&null!=$(".mobile-menu").css("display")?$(".navbar").outerHeight()+$(".footer").outerHeight()+$(".mobile-menu").outerHeight():$(".navbar").outerHeight()+$(".footer").outerHeight(),"none"!=$(".search-bar-large").css("display")&&null!=$(".search-bar-large").css("display")?(_navAndMenuAndFooterHeight+=$(".search-bar-large").outerHeight(),_deductHeight=110):_deductHeight=210,"none"!=$(".mainTable").css("display")&&null!=$(".mainTable").css("display")&&(_deductHeight+=$(".mainTable").outerHeight()),"none"!=$("#divBlockedTitle").css("display")&&null!=$("#divBlockedTitle").css("display")&&(_deductHeight+=$("#divBlockedTitle").outerHeight()),blockedIpTableHeight=(blockedIpTableHeight=Math.round(window.innerHeight-_navAndMenuAndFooterHeight-_deductHeight))<165?165:blockedIpTableHeight}function doOpenByBtn(){for(var e=new Array,a=$("input[name=radioBox_2]:checked"),t=0;t<a.length;t++)e.push(a[t].value);var o=$("#openReasonModal_reason").val();$.ajax({url:_ctx+"/delivery/doIpOpenByBtn.json",data:{listId:e,reason:o},type:"POST",async:!0,beforeSend:function(){showProcessing()},complete:function(){hideProcessing()},success:function(e){"200"==e.code?(alert(e.message),findBlockedIpRecordData("B"),setTimeout(function(){$("#openReasonModal").modal("hide")},500)):alert(e.message)},error:function(e,a,t){ajaxErrorHandler()}})}function findBlockedIpRecordData(e){calBlockedIpSectionHeight(),void 0!==resultTable_blockedIpRecord?resultTable_blockedIpRecord.ajax.reload():($("#divBlockedIpRecord").show(),resultTable_blockedIpRecord=$("#resultTable_blockedIpRecord").DataTable({autoWidth:!0,paging:!0,bFilter:!0,ordering:!0,info:!0,serverSide:!0,bLengthChange:!0,pagingType:"full",processing:!0,scrollX:!0,scrollY:blockedIpTableHeight,scrollCollapse:!0,language:{url:_ctx+"/resources/js/dataTable/i18n/Chinese-traditional.json"},createdRow:function(e,a,t){null!=a.blockReason&&a.blockReason.length>blockReasonShowLength&&($(e).children("td").eq(7).attr("onclick","javascript:showFullScript($(this));"),$(e).children("td").eq(7).addClass("cursor_zoom_in")),$(e).children("td").eq(7).attr("content",a.blockReason),null!=a.openReason&&a.openReason.length>openReasonShowLength&&($(e).children("td").eq(10).attr("onclick","javascript:showFullScript($(this));"),$(e).children("td").eq(10).addClass("cursor_zoom_in")),$(e).children("td").eq(10).attr("content",a.openReason)},ajax:{url:_ctx+"/delivery/getBlockedIpData.json",type:"POST",data:function(a){return"WEB"==$("#queryFrom").val()?a.queryGroupId=$("#queryGroup").val():"MOBILE"==$("#queryFrom").val()&&(a.queryGroupId=$("#queryGroup_mobile").val()),"B"==e&&(a.queryStatusFlag=e),a},error:function(e,a,t){ajaxErrorHandler()}},order:[[6,"desc"]],pageLength:100,drawCallback:function(e){$("div.dataTables_length").parent().removeClass("col-sm-12"),$("div.dataTables_length").parent().addClass("col-sm-6"),$("div.dataTables_filter").parent().removeClass("col-sm-12"),$("div.dataTables_filter").parent().addClass("col-sm-6"),$("div.dataTables_info").parent().removeClass("col-sm-12"),$("div.dataTables_info").parent().addClass("col-sm-6"),$("div.dataTables_paginate").parent().removeClass("col-sm-12"),$("div.dataTables_paginate").parent().addClass("col-sm-6"),bindTrEventForSpecifyTableRadio("dataTable_2","radioBox_2");var a=window.location.pathname,t=a.substring(a.lastIndexOf("/"),a.length);"/ipOpenBlock"===t?($('[data-field="status"]').hide(),$('[data-field="openTime"]').hide(),$('[data-field="openReason"]').hide(),$('[data-field="openBy"]').hide(),recordSectionRadioBoxOnChangeEvent()):"/ipBlocked"===t&&$('[data-field="action"]').hide(),$.fn.dataTable.tables({visible:!0,api:!0}).columns.adjust()},rowCallback:function(e,a){$("td:eq(0)",e).attr("data-field","action"),$("td:eq(1)",e).attr("data-field","seq"),$("td:eq(2)",e).attr("data-field","groupName"),$("td:eq(3)",e).attr("data-field","ipAddress"),$("td:eq(4)",e).attr("data-field","ipDesc"),$("td:eq(5)",e).attr("data-field","status"),$("td:eq(6)",e).attr("data-field","blockTime"),$("td:eq(7)",e).attr("data-field","openTime"),$("td:eq(8)",e).attr("data-field","blockReason"),$("td:eq(9)",e).attr("data-field","openReason"),$("td:eq(10)",e).attr("data-field","blockBy"),$("td:eq(11)",e).attr("data-field","openBy")},columns:[{},{},{data:"groupName",className:"left"},{data:"ipAddress",className:"left"},{data:"ipDesc",className:"left"},{data:"statusFlag",className:"center"},{data:"blockTimeStr",className:"center"},{data:"openTimeStr",className:"center"},{},{},{data:"blockBy",className:"center"},{data:"openBy",className:"center"}],columnDefs:[{targets:[0],className:"center",searchable:!1,orderable:!1,render:function(e,a,t){return'<input type="radio" id="radioBox_2" name="radioBox_2" onclick="changeTrBgColor(this)" value='+t.listId+">"}},{targets:[1],className:"center",searchable:!1,orderable:!1,render:function(e,a,t,o){return o.row+o.settings._iDisplayStart+1}},{targets:[8],className:"left",searchable:!0,orderable:!1,render:function(e,a,t){return null!=t.blockReason&&t.blockReason.length>blockReasonShowLength?getPartialContentHtml(t.blockReason,blockReasonShowLength):t.blockReason}},{targets:[9],className:"left",searchable:!0,orderable:!1,render:function(e,a,t){return null!=t.openReason&&t.openReason.length>openReasonShowLength?getPartialContentHtml(t.openReason,openReasonShowLength):t.openReason}}]}))}$(document).ready(function(){});