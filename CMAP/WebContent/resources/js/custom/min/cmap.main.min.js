feather.replace();var resultTable,navAndMenuAndFooterHeight,deductHeight,dataTableHeight,_ctx=$("meta[name='ctx']").attr("content"),_timeout=$("meta[name='timeout']").attr("content"),isWEB=!0;function initMenuStatus(e,t,a){$("#"+e+" > span > svg.feather-chevron-down").replaceWith(feather.icons["chevron-up"].toSvg()),$("#"+t).removeClass("collapse"),$("#"+a).addClass("yellow")}function initCheckedItems(){var e=JSON.parse(window.sessionStorage.getItem(_DATATABLE_CHECKED_ITEM_));null!=e&&e.length>0&&$.each(e,function(e,t){$("input[name=chkbox][value="+t+"]").trigger("click")})}function bindTrEvent(){$(".dataTable tbody tr").click(function(e){"A"!==e.target.tagName&&"checkbox"!==e.target.type&&"radio"!==e.target.type&&($(":checkbox",this).trigger("click"),$(":radio",this).prop("checked",!$(":radio",this).is(":checked")),"radio"===$("#chkbox",this).attr("type")&&changeTrBgColor($("#chkbox",this).get(0)))})}function uncheckAll(){$("input[name=checkAll]").prop("checked",!1),$("input[name=chkbox]").prop("checked",!1),$("tbody > tr").removeClass("mySelected")}function unfoldMobileMenu(){}function initModal(){$("input[name^=input]").val(""),$("textarea[name^=input]").val(""),$("select").prop("selectedIndex",0),$(".modal").find(":disabled").attr("disabled",!1),$("div[id^=sec_]").hide()}function toggleMenu(){isWEB?($(".web-menu").toggleClass("d-md-block"),$("main").toggleClass("col-md-10").toggleClass("col-md-12"),$("footer").toggleClass("col-md-10").toggleClass("col-md-12")):($(".mobile-menu").toggleClass("d-none"),$("#search-bar-small-btn").toggleClass("search-bar-small-btn")),changeMenuIconColor(),calHeight(),$(window).trigger("resize")}function changeMenuIconColor(){$("#menu-icon").toggleClass("icon-hightlight")}function changeTrBgColor(e){"radio"==$(e).attr("type")&&$("tbody > tr").removeClass("mySelected"),setTimeout(function(){var t=e.parentNode.parentNode;e.checked?t.classList.add("mySelected"):t.classList.remove("mySelected")},100)}function calHeight(){navAndMenuAndFooterHeight="none"!=$(".mobile-menu").css("display")?$(".navbar").outerHeight()+$(".footer").outerHeight()+$(".mobile-menu").outerHeight():$(".navbar").outerHeight()+$(".footer").outerHeight(),"none"!=$(".search-bar-large").css("display")?(navAndMenuAndFooterHeight+=$(".search-bar-large").outerHeight(),deductHeight=160):deductHeight=250,dataTableHeight=(dataTableHeight=window.innerHeight-navAndMenuAndFooterHeight-deductHeight)<165?165:dataTableHeight}function changeDeviceMenu(e,t){$("select[id^='"+e+"'] option").remove(),$("select[id^='"+e+"']").append("<option value=''>=== ALL ===</option>"),$.ajax({url:_ctx+"/base/getDeviceMenu",data:{groupId:t},type:"POST",dataType:"json",async:!0,success:function(t){if("200"==t.code){var a=$.parseJSON(t.data.device);$.each(a,function(t,a){$("select[id^='"+e+"']").append("<option value='"+t+"'>"+a+"</option>")})}},error:function(e,t,a){ajaxErrorHandler()}})}function viewConfig(e){var t=new Object;t.name="versionId",t.value=e,$.ajax({url:_ctx+"/version/view",data:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json"},type:"POST",async:!0,beforeSend:function(){showProcessing()},complete:function(){hideProcessing()},success:function(e){"200"==e.code?($("#viewModal_group").val(e.data.group),$("#viewModal_device").val(e.data.device),$("#viewModal_version").val(e.data.version),$("#viewModal_content").html(e.data.content),$("#viewModal").modal("show")):alert(e.message)},error:function(e,t,a){ajaxErrorHandler()}})}function ajaxErrorHandler(){alert("連線逾時，頁面將重新導向"),location.reload()}function changeShowContent(e,t){var a=$(e).attr("content");null!=a&&""!=a&&("true"==$(e).attr("isDetail")?($(e).attr("isDetail",!1),$(e).html(getPartialContentHtml(a,t)),$(e).switchClass("cursor_zoom_out","cursor_zoom_in")):($(e).attr("isDetail",!0),$(e).html(getTotalContentHtml(a)),$(e).switchClass("cursor_zoom_in","cursor_zoom_out"))),adjustDataTableWidth()}function getPartialContentHtml(e,t){return e.substr(0,t)+'&nbsp;&nbsp;<a href="javascript:void(0);" >...(顯示)</a>'}function adjustDataTableWidth(){$.fn.dataTable.tables({visible:!0,api:!0}).columns.adjust()}function getTotalContentHtml(e){return e+'&nbsp;&nbsp;<a href="javascript:void(0);" >(隱藏)</a>'}$(document).ready(function(){window.sessionStorage.clear();var e=window.location.pathname;"/CMAP/"==e||"/CMAP/index"==e?$('.nav > .nav-item > a[href="/CMAP/version/manage"]').addClass("active"):$('.nav > .nav-item > a[href="'+e+'"]').addClass("active"),$(".mobile-menu").is(":visible")&&(isWEB=!1),$(".toggleMenuLink").click(function(){var e="#"+this.id+"_items",t="#"+this.id+" > span > svg.feather-";$(e).toggleClass("collapse"),$(e).hasClass("collapse")?(t+="chevron-up",$(t).replaceWith(feather.icons["chevron-down"].toSvg())):(t+="chevron-down",$(t).replaceWith(feather.icons["chevron-up"].toSvg()))}),calHeight(),$(window).resize(_.debounce(function(){if(void 0!==resultTable&&(calHeight(),$(".dataTables_scrollBody").css("max-height",dataTableHeight),resultTable.ajax.reload(),void 0!==$("#checkAll")&&$("input[name=checkAll]").prop("checked",!1),"function"==typeof initActionBar&&initActionBar()),"undefined"!=typeof resultTable_errorLog&&(calHeight(),$(".dataTables_scrollBody").css("max-height",dataTableHeight),resultTable_errorLog.ajax.reload(),void 0!==$("#checkAll")&&$("input[name=checkAll]").prop("checked",!1),"function"==typeof initActionBar&&initActionBar()),"undefined"!=typeof resultTable_jobLog&&(calHeight(),$(".dataTables_scrollBody").css("max-height",dataTableHeight),resultTable_jobLog.ajax.reload(),void 0!==$("#checkAll")&&$("input[name=checkAll]").prop("checked",!1),"function"==typeof initActionBar&&initActionBar()),"undefined"!=typeof resultTable_blockIpRecord&&(calHeight(),$(".dataTables_scrollBody").css("max-height",dataTableHeight),resultTable_blockIpRecord.ajax.reload(),void 0!==$("#checkAll")&&$("input[name=checkAll]").prop("checked",!1),"function"==typeof initActionBar&&initActionBar()),$("#chkbox").length>0){var e=[];$.each($("input[name=chkbox]:checked"),function(t,a){e.push(a.value)}),window.sessionStorage.setItem(_DATATABLE_CHECKED_ITEM_,JSON.stringify(e))}},1e3)),$("#checkAll").click(function(e){$(this).is(":checked")?($("input[name=chkbox]").prop("checked",!0),$("tbody > tr").addClass("mySelected")):($("input[name=chkbox]").prop("checked",!1),$("tbody > tr").removeClass("mySelected"))}),$("#btnSearch_web").click(function(e){findData("WEB")}),$("#btnSearch_mobile").click(function(e){findData("MOBILE")}),$("#viewModal").on("shown.bs.modal",function(){setTimeout(function(){$("#viewModal_content").scrollTop(0)},30)}),$('[data-toggle="tooltip"]').tooltip({placement:"top",html:!0}),$(".dataTable thead td").click(function(){bindTrEvent()}),$(".cron-info").on("mouseover",function(e){var t=$("#details-pane"),a=$("#details-pane .title"),n=$("#details-pane .content"),o=$(this).attr("data-type"),i=$(this).attr("data-title"),c=$(this).attr("data-text"),l=$(this).offset(),s=$(this).width(),r=l.top;if(l.left/$(window).width()>=.5)var d=l.left-820;else d=l.left+s;a.html(i),"JOB_CRON"==o?(n.html('<img src="'+_ctx+'/resources/images/CronExpression.png" width="800px" height="auto" />'),r-=200):"TEXT"==o&&n.html("<span>"+c+"</span>"),t.css({left:d,top:r,display:"block"})}).on("mouseout",function(e){$("#details-pane").css("display","none")}),$("#details-pane").on("mouseover",function(e){$(this).css("display","block")}),$("#details-pane").on("mouseout",function(e){(e=e.toElement||e.relatedTarget).parentNode!=this&&e.parentNode.parentNode!=this&&e.parentNode.parentNode.parentNode!=this&&e!=this&&$(this).css("display","none")})}),$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e};