var startNum,pageLength;function findData(e){$("#queryFrom").val(e),"MOBILE"==e&&$("#collapseExample").collapse("hide"),startNum=0,"undefined"!=typeof resultTable?($(".dataTables_scrollBody").scrollTop(0),resultTable.ajax.reload(),$(".myTableSection").show()):($(".myTableSection").show(),resultTable=$("#resultTable").DataTable({autoWidth:!0,paging:!1,bFilter:!1,ordering:!0,info:!0,serverSide:!0,bLengthChange:!0,pagingType:"full",processing:!0,scrollX:!0,scrollY:dataTableHeight,scrollCollapse:!0,pageLength:pageLength,language:{url:_ctx+"/resources/js/dataTable/i18n/Chinese-traditional.json"},createdRow:function(e,a,t){},ajax:{url:_ctx+"/admin/inventory/getInventoryInfoData.json",type:"POST",data:function(e){return"WEB"==$("#queryFrom").val()&&(e.queryProbe=$("#queryProbe").val(),e.queryDeviceName=$("#queryDeviceName").val(),e.queryDeviceType=$("#queryDeviceType").val(),e.queryBrand=$("#queryBrand").val(),e.queryModel=$("#queryModel").val()),e.start=0,e.length=pageLength,e},beforeSend:function(){countDown("START")},complete:function(){countDown("STOP")},error:function(e,a,t){ajaxErrorHandler()},timeout:1e3*parseInt(_timeout)},order:[[5,"acs"]],initComplete:function(e,a){null!=a.msg&&($(".myTableSection").hide(),alert(a.msg)),bindScrollEvent()},drawCallback:function(e){$("div.dataTables_filter").parent().removeClass("col-sm-12"),$("div.dataTables_filter").parent().addClass("col-sm-6"),$("div.dataTables_info").parent().removeClass("col-sm-12"),$("div.dataTables_info").parent().addClass("col-sm-6"),startNum=pageLength,lastScrollYPos=$(".dataTables_scrollBody").prop("scrollTop"),$("#resultTable_filter").find("input").prop("placeholder","(模糊查詢速度較慢)"),bindTrEvent()},columns:[{},{data:"deviceId",orderable:!1},{data:"probe",orderable:!1},{data:"group",orderable:!1},{data:"deviceName",orderable:!1},{data:"deviceIp",orderable:!1},{data:"deviceType",orderable:!1},{data:"brand",orderable:!1},{data:"model",orderable:!1},{data:"systemVersion",orderable:!1},{data:"serialNumber",orderable:!1},{data:"manufactureDate",orderable:!1}],columnDefs:[{targets:[0],className:"center",searchable:!1,orderable:!1,render:function(e,a,t,r){return r.row+r.settings._iDisplayStart+1}}]}))}function countDown(e){if("START"==e)startTime=parseInt(_timeout)-1,timer_start=performance.now(),timer=setInterval(function(){$("#timeoutMsg").val("Timeout倒數 : "+startTime+" 秒"),startTime--},1e3);else{timer_end=performance.now();var a=(parseInt(timer_end)-parseInt(timer_start))/1e3;$("#timeoutMsg").val("查詢花費時間 : "+a+" 秒"),clearInterval(timer)}}function bindScrollEvent(){$(".dataTables_scrollBody").scroll(function(e){if(0==$(".dataTables_empty").length){var a=$("#resultTable > tBody > tr").length,t=$(this).prop("scrollTop"),r=$(this).prop("scrollHeight")-$(this).prop("clientHeight");t>lastScrollYPos&&(lastScrollYPos=t,a>=pageLength&&t>=r-100&&(waitForNextData||(waitForNextData=!0,findNextData())))}})}function doDataExport(e){var a=new Object;"WEB"==$("#queryFrom").val()&&(a.queryProbe=$("#queryProbe").val(),a.queryDeviceName=$("#queryDeviceName").val(),a.queryDeviceType=$("#queryDeviceType").val(),a.queryBrand=$("#queryBrand").val(),a.queryModel=$("#queryModel").val()),a.start=0,a.length=pageLength,a.exportRecordCount=e,$.ajax({url:_ctx+"/admin/inventory/dataExport.json",data:a,type:"POST",dataType:"json",async:!0,beforeSend:function(e){showProcessing()},complete:function(){hideProcessing()},initComplete:function(e,a){},success:function(e){if(200==e.code){const a=e.data.fileId,t=getResourceDownloadLink(a);location.href=t,closeExportPanel()}else alert(e.message)},error:function(e,a,t){ajaxErrorHandler()}})}$(document).ready(function(){initMenuStatus("toggleMenu_admin","toggleMenu_admin_items","bk_inventory"),startNum=0,pageLength=Number($("#pageLength").val())});